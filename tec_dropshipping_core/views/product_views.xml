<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <!-- No more local brand model, we use tec.catalog.brand from catalog_pro -->

    <!-- Inherit Product Template View for Brand Field -->
    <record id="product_template_form_view_inherit_brand" model="ir.ui.view">
        <field name="name">product.template.form.inherit.brand</field>
        <field name="model">product.template</field>
        <field name="inherit_id" ref="product.product_template_form_view"/>
        <field name="arch" type="xml">
            <!-- 1. Centralized group for ALL our custom fields -->
            <xpath expr="//group[@name='group_general']" position="inside">
                <group string="Valores Dropshipping / USD" name="dropship_prices">
                    <field name="product_brand_id" options="{'no_create_edit': True}"/>
                    <field name="x_manufacturer_pn"/>
                    <field name="x_usd_price" widget="monetary" options="{'currency_field': 'usd_currency_id'}" decoration-bf="1"/>
                    <field name="x_usd_cost" widget="monetary" options="{'currency_field': 'usd_currency_id'}"/>
                </group>
            </xpath>
            <xpath expr="//notebook" position="inside">
                <page string="Contenido &amp; Media" name="air_data">
                    <group>
                        <group string="Enriquecimiento (Origen)">
                            <field name="air_has_description" readonly="1"/>
                            <field name="air_has_images" readonly="1"/>
                            <field name="air_description_raw" placeholder="Descripción técnica cruda..." readonly="1"/>
                        </group>
                        <group string="Imágenes Adicionales (Backend)">
                            <field name="tec_product_image_ids" nolabel="1">
                                <list editable="bottom">
                                    <field name="sequence" widget="handle"/>
                                    <field name="image_1920" widget="image" options="{'size': [64, 64]}" string="Imagen"/>
                                    <field name="name"/>
                                </list>
                            </field>
                        </group>
                    </group>
                    <group string="Descripción Enriquecida (Copia de Seguridad - IA)">
                        <field name="tec_enriched_description" nolabel="1" placeholder="Aquí aparecerá la descripción generada por IA..."/>
                    </group>
                </page>
            </xpath>
        </field>
    </record>

    <!-- Use inheritance on Supplier Info base view -->
    <!-- We ONLY inherit the base one to avoid double columns if purchase is installed -->
    <record id="product_supplierinfo_tree_view_inherit_dropship" model="ir.ui.view">
        <field name="name">product.supplierinfo.list.inherit.dropship</field>
        <field name="model">product.supplierinfo</field>
        <field name="inherit_id" ref="product.product_supplierinfo_tree_view"/>
        <field name="arch" type="xml">
            <xpath expr="//list" position="inside">
                <field name="dropship_location_id" string="Sucursal" optional="show"/>
                <field name="x_vendor_stock" string="Stock Proveedor" optional="show"/>
            </xpath>
        </field>
    </record>

    <!-- Inherit Product Template Tree View for Nodes Stock -->
    <record id="product_template_tree_view_inherit_dropship" model="ir.ui.view">
        <field name="name">product.template.list.inherit.dropship</field>
        <field name="model">product.template</field>
        <field name="inherit_id" ref="product.product_template_tree_view"/>
        <field name="arch" type="xml">
            <field name="standard_price" position="after">
                <field name="stock_cba" string="Stock CBA" sum="Total CBA" decoration-info="stock_cba > 0" optional="show"/>
                <field name="stock_bsas" string="Stock BSAS" sum="Total BSAS" decoration-info="stock_bsas > 0" optional="show"/>
                <field name="air_has_description" string="Air Desc" widget="boolean_toggle" optional="show"/>
                <field name="air_has_images" string="Air Img" widget="boolean_toggle" optional="show"/>
            </field>
        </field>
    </record>

    <!-- Inherit Product Search View -->
    <record id="product_template_search_view_inherit_brand" model="ir.ui.view">
        <field name="name">product.template.search.inherit.brand</field>
        <field name="model">product.template</field>
        <field name="inherit_id" ref="product.product_template_search_view"/>
        <field name="arch" type="xml">
            <field name="name" position="after">
                <field name="product_brand_id"/>
                <field name="x_manufacturer_pn"/>
            </field>
            <filter name="filter_to_sell" position="after">
                <filter string="Marca" name="group_brand" context="{'group_by':'product_brand_id'}"/>
            </filter>
        </field>
    </record>
</odoo>
